<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web To PDF Converter</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Web To PDF Converter <br> by Timur Hasenfratz</h1>
  <div class="Container">
  <form class="search" action="/generate-pdf" method="post" id="pdfForm">
    <label for="url">Enter URL:</label>
    <input type="text" id="url" name="url" placeholder="https://timur-hasenfratz.com/" required>
    <br>
  
    <p>Choose a basic CSS change:</p>
    <div id="basicCss" class="css-panel">
      <button onclick="prev()"><</button>
      <div class="css-panel" id="slider-container">
   
      <button type="button" onclick="addCss('nav { display:none!important; }')">HideNavbar</button>
      <button type="button" onclick="addCss('body { width: 100%; max-width:1200px!important;zoom:80%;!important}')">BodyFix</button>
      <button type="button" onclick="addCss('img {display:block!important; }')">imgFix</button>
      <button type="button" onclick="addCss('* {display:block!important;}')">showAll</button>
      <button type="button" onclick="addCss('* {text-align:center;}')">centerAllText</button>

      <!-- Add more basic CSS classes here -->
    </div>
    <button onclick="next()">></button>
    </div>
    <br>
    <label for="css">Add Custom CSS:</label>
    <textarea id="css" name="css" rows="10" cols="50"> 
   
        nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
        }
        body::after {
          content: "";
          display: block;
          page-break-after: always;
        }
        nav + * {
          page-break-before: always;
        }
        body {
          zoom: 60%;
        }
      

    </textarea>
    <br>
    <label for="js">Add JavaScript:</label>
    <textarea id="js" name="js" rows="4" cols="50"></textarea>
    <br>
    <button type="submit">Generate PDF</button>
   
  </form>
  <div id="preview">
    <!-- PDF preview will be displayed here -->
  </div>
</div>
  

  <div id="usedCssClasses">
    <h2>Used CSS Classes</h2>
    <ul id="cssClassesList"></ul>
  </div>

  <script>
    function showPreview(imageSrc) {
      const previewDiv = document.getElementById('preview');
      previewDiv.innerHTML = `<h2 style="color:white;">PDF Preview</h2><img src="${imageSrc}" alt="PDF Preview"><br><br><br><br><a style="font-size:1.6rem; color:white; padding:0.4rem;" href="example.pdf" download="output.pdf">Download PDF</a>`;
    }

    function addCss(css) {
      document.getElementById('css').value += css + '\n';
    }

    const urlParams = new URLSearchParams(window.location.search);
    const previewImage = urlParams.get('previewImage');
    const usedCssClasses = urlParams.get('usedCssClasses');

    if (previewImage) {
      showPreview(previewImage);
    }

    if (usedCssClasses) {
      const cssClassesList = document.getElementById('cssClassesList');
      JSON.parse(usedCssClasses).forEach(className => {
        const listItem = document.createElement('li');
        listItem.textContent = className;
        cssClassesList.appendChild(listItem);
      });
    }

    // Live Preview
    const form = document.getElementById('pdfForm');
    form.addEventListener('input', async () => {
      const url = document.getElementById('url').value;
      const css = document.getElementById('css').value;
      const js = document.getElementById('js').value;

      if (url) {
        try {
          const response = await fetch('/generate-preview', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ url, css, js })
          });

          const data = await response.json();
          if (data.previewImage) {
            showPreview(data.previewImage);
          }
        } catch (error) {
          console.error('Error generating live preview:', error);
        }
      }
    });
  </script>
  <script>
    function prev() {
  document.getElementById("slider-container").scrollLeft -= 170;
}
// for scroll right button
function next() {
  document.getElementById("slider-container").scrollLeft += 170;
}
  </script>
</body>
</html>
